# Dockerfile for Nessus
FROM tenable/nessus:latest-ubuntu

# Expose the Nessus port
EXPOSE 8834

# Create an entrypoint script to initialize Nessus using environment variables
RUN echo "#!/bin/sh\n\
/opt/nessus/sbin/nessusd\n\
sleep 10\n\
/opt/nessus/sbin/nessuscli adduser $NESSUS_ADMIN_USERNAME --password=$NESSUS_ADMIN_PASSWORD\n\
/opt/nessus/sbin/nessuscli fetch --register $NESSUS_LICENSE_CODE\n\
tail -f /opt/nessus/var/nessus/logs/nessusd.messages" > /entrypoint.sh

RUN chmod +x /entrypoint.sh

ENTRYPOINT ["/entrypoint.sh"]
