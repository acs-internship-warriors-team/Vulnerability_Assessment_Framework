# Vulnerability Assessment Framework

## Project Overview

The Vulnerability Assessment Framework is designed to perform comprehensive reconnaissance and vulnerability assessments on given domains. It utilizes multiple tools to gather information about the domain, including subdomain enumeration, IP address discovery, SSL/TLS scanning, and vulnerability scanning. The results are saved into a database for further analysis and reporting.

## Setup Instructions

### Prerequisites

- Python 3.8+
- Flask
- Flask-SQLAlchemy
- Requests
- Sublist3r
- ZAP (OWASP Zed Attack Proxy)
- Nikto
- Docker (for running Nessus)

### Installation

1. **Clone the repository:**

    ```
    git clone https://github.com/your-username/vulnerability-assessment-framework.git
    cd vulnerability-assessment-framework
    ```

2. **Create and activate a virtual environment:**

    ```
    python -m venv venv
    source venv/bin/activate  # On Windows use `venv\Scripts\activate`
    ```

3. **Install the required dependencies:**

    ```
    pip install -r requirements.txt
    ```

4. **Set up environment variables:**

    Create a `.env` file in the project root directory and add the following variables:

    ```
    FLASK_APP=run.py
    FLASK_ENV=development
    ZAP_URL=http://localhost:8080
    ZAP_API_KEY=your-zap-api-key
    NESSUS_URL=http://localhost:8834
    NESSUS_USERNAME=your-username
    NESSUS_USERNAME=your-password
    DATABASE_URI=sqlite:///site.db  # or your preferred database URI
    ```

5. **Initialize the database:**

    ```
    flask db init
    flask db migrate -m "Initial migration"
    flask db upgrade
    ```

6. **Run the application:**

    ```
    python ./run.py
    ```

7. **Build in docker**
   
    ```
    docker build -t vulnerability_assessment_framework_backend .
     ```

8. **Run in docker**

    ```
    docker run -d -p 5000:5000 vulnerability_assessment_framework_backend
    ```

    

## Project Structure

```
vulnerability-assessment-framework/backend/
│
├── app/
│   ├── __init__.py
│   ├── routes.py
│   ├── tools/
│   │   ├── __init__.py
│   │   ├── recon_tools.py
│   │   ├── network_scan_tools.py
│   │   ├── vuln_assessment_tools.py
│   ├── models.py
│   ├── database.py
├── config.py
├── run.py
├── requirements.txt
└── README.md
```

## Main Functionalities

### Reconnaissance Tools (`recon_tools.py`)

- **get_subdomains(domain)**: Uses Sublist3r to enumerate subdomains for a given domain.
- **get_domain_ip_addresses(domain)**: Resolves the domain to its corresponding IP addresses.
- **get_domain_subdomains_ip_addresses(domain, subdomains)**: Resolves the subdomains to their corresponding IP addresses.
- **find_virtual_hosts(domain)**: Uses `vhostfinder` to discover virtual hosts for the domain.
- **get_leaked_api_tokens(domain)**: Searches for leaked API tokens associated with the domain.
- **whois_lookup(domain)**: Performs a WHOIS lookup for the domain.
- **reverse_dns_lookup(domain)**: Conducts a reverse DNS lookup.
- **ssl_tls_scan(domain)**: Scans the domain for SSL/TLS configurations.
- **dns_records_enumeration(domain)**: Enumerates DNS records for the domain.

### Network Scan Tools (`network_scan_tools.py`)

- **port_scan(ip_address)**: Scans the given IP address for open ports.
- **service_version_scan(ip_address)**: Detects services and their versions running on the open ports.
- **analyze_http_headers(domain)**: Analyzes HTTP headers for the domain.

### Vulnerability Assessment Tools (`vuln_assessment_tools.py`)

- **scan_vulnerabilities(domain)**: Uses Nikto and ZAP to scan the domain for vulnerabilities. The results are collected and returned in JSON format.

### Database Operations (`database.py`)

- **save_scan_result(result_data)**: Saves the scan results into the database using SQLAlchemy.

### API Routes (`routes.py`)

- **GET /api/v1/scan-domain**: Triggers the scan for a given domain and returns the results.

### Configuration (`config.py`)

- Configuration settings for the application, including ZAP API settings and database URI.

## Running the Application

1. **Start the Flask server:**

    ```sh
    python ./run.py
    ```

2. **Access the application:**

    Open your web browser and navigate to `http://localhost:5000`.

3. **Perform a scan:**

    Send a POST request to `/api/v1/scan-domain` with the domain to be scanned in the request body:

    ```json
    {
        "domain": "example.com"
    }
    ```

    ```
    curl -X POST http://localhost:5000/api/v1/scan-domain -H "Content-Type: application/json" -d '{"domain": "example.com"}'
    ```


## Troubleshooting

- Ensure that all dependencies are installed and services like ZAP are running.
- Check the environment variables and ensure they are correctly set.
- Refer to the error logs for debugging issues related to the scan processes.
