import ApiEndpoints from "../core/apiEndPoints";
import httpClient from "../core/axios";

export const scanDomain = (domain) => {
  return new Promise(async (resolve, reject) => {
    try {
      const domainPattern = /^(?!:\/\/)([a-zA-Z0-9-_]{1,63}\.)+[a-zA-Z]{2,6}$/;

      if (!domain || !domainPattern.test(domain)) {
        return reject("Invalid domain");
      }

      const response = await httpClient().post(ApiEndpoints.scanDomain, {
        domain,
      });

      return resolve(response.data);
    } catch (error) {
      return reject("Something went wrong! Try again later");
    }
  });
};
