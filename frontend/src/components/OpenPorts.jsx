import React, { useState, useEffect } from "react";
import {
  Typography,
  Table,
  TableBody,
  TableCell,
  TableContainer,
  TableHead,
  TableRow,
  Paper,
} from "@mui/material";

const wellKnownPorts = {
  20: "FTP Data Transfer",
  21: "FTP Command Control",
  22: "SSH",
  23: "Telnet",
  25: "SMTP",
  53: "DNS",
  80: "HTTP",
  110: "POP3",
  143: "IMAP",
  443: "HTTPS",
  465: "SMTPS",
  993: "IMAPS",
  995: "POP3S",
  3306: "MySQL",
  3389: "RDP",
  5432: "PostgreSQL",
  6379: "Redis",
  8080: "HTTP Alternate",
  8443: "HTTPS Alternate",
  // Add more well-known ports and services as needed
};

const OpenPort = ({ data }) => {
  return (
    <div>
      <Typography variant="h5" gutterBottom>
        Open Ports
      </Typography>
      <TableContainer component={Paper}>
        <Table>
          <TableHead>
            <TableRow>
              <TableCell sx={{ fontWeight: "bold", fontSize: "1.2rem" }}>
                Ports
              </TableCell>
              <TableCell sx={{ fontWeight: "bold", fontSize: "1.2rem" }}>
                Services
              </TableCell>
            </TableRow>
          </TableHead>
          <TableBody>
            {data.port_scan.success && data.port_scan.result
              ? data.port_scan.result.map((port, index) => (
                  <TableRow key={index}>
                    <TableCell>{port}</TableCell>
                    <TableCell>
                      {wellKnownPorts[port] || "Unknown Service"}
                    </TableCell>
                  </TableRow>
                ))
              : null}
          </TableBody>
        </Table>
      </TableContainer>
    </div>
  );
};

export default OpenPort;
